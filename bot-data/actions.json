{"command:getuserinfo":"{\"method\":\"post\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getuserinfo\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"userroles\",\"value\":\"$.userinfo.userroles\",\"description\":\"\"}]}","command:timestamp":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"return Math.floor(Date.now() / 1000);\",\"request\":{\"params\":[],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"timestamp\",\"value\":\"\",\"description\":\"\"}]}","command:getpostbyname":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getpostbyname|Konsultācijas\",\"description\":\"\",\"locked\":false},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"post_body\",\"value\":\"$.*.post_body\",\"description\":\"\"},{\"key\":\"discussion_id\",\"value\":\"$.*.discussion_id\",\"description\":\"\"},{\"key\":\"post_id\",\"value\":\"$.*.post_id\",\"description\":\"\"}]}","command:getquizzesstats":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getquizzesstats|7\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"quizzesstats\",\"value\":\"$\",\"description\":\"\"}]}","command:getquizzesstats:JS:getIDs":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\nvar resobj = JSON.parse(quizzes);\\nvar result = [];\\nfor (const key in resobj) {\\n  result.push(resobj[key].id);    \\n }\\nreturn result;\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"quizzesIDs\",\"value\":\"\",\"description\":\"\"}]}","command:sendmsgmultipleusers":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var conversationid = getcontext(\\\"@@conversationid\\\");\\nvar host = getcontext(\\\"@@host\\\");\\nvar userid = getcontext(\\\"userid\\\");\\nvar courseid = getcontext(\\\"courseid\\\");\\n var user = userlist.split(\\\",,\\\");\\n\\nfor (var i = 0; i < user.length; i++) {\\nvar url = host+\\\"/blocks/tildeva/chat_ajax.php?action='msg'&chat_msg=command:sendmsg|\\\"+user[i]+\\\"|\\\"+msg+\\\"&chat_usid=\\\"+userid+\\\"&chat_convid=\\\"+conversationid+\\\"&chat_couid=\\\" + courseid;\\nvar resp = httpget(url);\\n if (resp && resp != \\\"\\\" && resp.indexOf(\\\"error:\\\") != 0) {    \\n  \\n    setcontext(\\\"apistatuss\\\", 200);\\n }\\n  else\\n  {\\n    setcontext(\\\"apistatuss\\\", 500);\\n  }\\n}\\n\",\"request\":{\"params\":[{\"key\":\"userlist\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"msg\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"}]}","command:getquizzesstats:JS:getStudentIDsString":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\nvar resobj = JSON.parse(quizzes);\\nvar firstKey = Object.keys(resobj)[0];\\n\\nif (firstKey) {\\n   var studentIds = resobj[firstKey].passuserids.concat(resobj[firstKey].failuserids).join(\\\",,\\\");\\n   return studentIds;\\n} else {\\n   return \\\"\\\";\\n}\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"studentIds\",\"value\":\"\",\"description\":\"\"}]}","getdata":"{\"method\":\"js\",\"url\":\"internal JavaScript\",\"detach\":false,\"body\":\"var content  = getcontext(contentkey);\\n\\nvar res =  jsonpath(content, path);\\n\\nif (res && res != null){\\n   return res;\\n}\\n\\nreturn placeholder;\",\"request\":{\"params\":[{\"key\":\"contentkey\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"path\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"placeholder\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"\",\"description\":\"\"}]}","command:version":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getversion\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"moodleversion\",\"value\":\"$.moodleversion\",\"description\":\"\"},{\"key\":\"pluginversion\",\"value\":\"$.pluginversion\",\"description\":\"\"}]}","command:getquizzesstats:JS:getNames":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\nvar resobj = JSON.parse(quizzes);\\nvar result = [];\\nfor (const key in resobj) {\\n  result.push(resobj[key].name);    \\n }\\nreturn result;\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"quizzesNames\",\"value\":\"\",\"description\":\"\"}]}","command:getteacherinfo":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getteacherinfo\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"id\",\"value\":\"$[0].id\",\"description\":\"\"},{\"key\":\"firstname\",\"value\":\"$[0].firstname\",\"description\":\"\"},{\"key\":\"lastname\",\"value\":\"$[0].lastname\",\"description\":\"\"},{\"key\":\"email\",\"value\":\"$[0].email\",\"description\":\"\"}]}","command:parseanswer":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var host = getcontext(\\\"@@host\\\");\\nvar courseid = getcontext(\\\"courseid\\\");\\nvar res = getcontext(answer);\\nvar wronganswer = getcontext(wronganswer);\\nvar erroranswer = getcontext(erroranswer);\\n\\nvar jsonRes = JSON.parse(res);\\nvar result = jsonRes.answer;\\n\\nif (result && result !== \\\"\\\" && result.toLowerCase().indexOf(\\\"error\\\") >= 0) {\\n    sendmessage(wronganswer);\\n    return erroranswer;\\n}\\n\\nif (result && result !== \\\"\\\" && result.toLowerCase().indexOf(\\\"sorry\\\") > 0) {\\n    sendmessage(wronganswer);\\n    return wronganswer;\\n} else {\\n    var urlRegex = /(https?:\\\\/\\\\/[^\\\\s]+\\\\.png[^\\\\s\\\\.]*)/gi;\\n\\n    // Replace URLs with Markdown links\\n    result = result.replace(urlRegex, function (url) {\\n        return '![' + url + '](' + url + ')\\\\{: .llmgpt\\\\}';\\n    });\\n\\n    var urlRegexgif = /(https?:\\\\/\\\\/[^\\\\s]+\\\\.gif[^\\\\s\\\\.]*)/gi;\\n\\n    // Replace URLs with Markdown links\\n    result = result.replace(urlRegexgif, function (url) {\\n        return '![' + url + '](' + url + ')\\\\{: .llmgpt\\\\}';\\n    });\\n\\n    var urlRegex2 = /https?:\\\\/\\\\/[^\\\\s]+\\\\.youtube.com\\\\/([^\\\\s\\\\.]*)/g;\\n    var isvideo = false;\\n\\n    // Replace URLs with Markdown links and set video context\\n    result = result.replace(urlRegex2, function (url) {\\n        setcontext(\\\"video\\\", url);\\n        isvideo = true;\\n        return url;\\n    });\\n\\n    if (jsonRes.metadata && jsonRes.metadata.length > 0) {\\n        var coursesections = getcontext(\\\"coursesections\\\");\\n        var readmore = \\\"\\\";\\n\\n        for (var key in jsonRes.metadata) {\\n            if (jsonRes.metadata[key].H1 && !(readmore.indexOf(jsonRes.metadata[key].H1) >= 0)) {\\n                if (coursesections) {\\n                    var sections = JSON.parse(coursesections);\\n                    for (var sectionKey in sections) {\\n                        let name = sections[sectionKey].name;\\n                        if (name.indexOf('.') !== -1) {\\n                            name = name.substring(name.indexOf('.') + 2);\\n                            if (jsonRes.metadata[key].H1.indexOf(name) >= 0) {\\n                               readmore += \\\"\\\\n \\\" + '' +  '[' + name + ']('+host+'/course/view.php?id='+courseid+'#section-' + sections[sectionKey].section + ')';\\n                            }\\n                        }\\n                    }\\n                } else {\\n                    readmore += \\\"\\\\n \\\" + '' + jsonRes.metadata[key].H1 + '';\\n                }\\n            }\\n        }\\n\\n        if (readmore !== \\\"\\\") {\\n            result += \\\"\\\\n*** \\\\n\\\\nVairāk: \\\" + readmore;\\n        }\\n    }\\n}\\n\\nif (!isvideo) {\\n    sendmessage(result);\\n} else {\\n    setcontext(\\\"videodescr\\\", result);\\n}\\n\\nreturn result;\\n\",\"request\":{\"params\":[{\"key\":\"answer\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"wronganswer\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"erroranswer\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"\",\"description\":\"\"}]}","command:getquizzesstats:JS:getStudentIDs":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\nvar resobj = JSON.parse(quizzes);\\nvar firstKey = Object.keys(resobj)[0];\\n\\nif (firstKey) {\\n   var studentIds = resobj[firstKey].passuserids.concat(resobj[firstKey].failuserids);\\n   return studentIds;\\n} else {\\n   return [];\\n}\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"studentIds\",\"value\":\"\",\"description\":\"\"}]}","command:getcourseinfo":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getcourseinfo\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"coursefullname\",\"value\":\"$.courseinfo.coursefullname\",\"description\":\"\"}]}","command:getquizzes":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getquizzes\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"quizzesstats\",\"value\":\"$\",\"description\":\"\"}]}","newcontextGPT":"{\"method\":\"post\",\"url\":\"http://gptqna/newcontext\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[],\"authorization\":[\"\"],\"headers\":[],\"formData\":[{\"key\":\"site\",\"value\":\"[\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/CA_apraksti.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/CA_apraksti_2.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/9_radiacijas_bistamo_kimisko_vielu_un_biol_agentu_ietekme_uz_cilv.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/8_pirmas_palidzibas_sniegsana.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/7_dzivibas_glabsanas_BLS.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/6_pirma_palidziva_NMP_katastrofu_med.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/5_CA_ES_NATO.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/4_civilas_trauksmes_un_apzinosanas_sistema.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/3_iespejamas_katastrofas_un_to_sekas.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/2_katastrofu_parvaldisana_planosana_un_pasakumu_istenosana.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/1_civilas_aizsardzibas_sistema_valsti.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/11_labas_prakses_piemeri_un_pieredze_no_starptautiskajam_misijam.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/10_riciba_ugunsgreka_gadijuma_un_evakuacija.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/1_Studiju_kursa_apraksts_CivilaAizsardziba_v4.md?timestamp=#timestamp#.md\\\",\\\"https://raw.githubusercontent.com/e-kornejeva/CA/main/Minecraft_Education_pamatdarbibu_instrukcija.md?timestamp=#timestamp#.md\\\"]\",\"description\":\"\",\"locked\":true},{\"key\":\"topic\",\"value\":\"camd\",\"description\":\"\",\"locked\":true}]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"msg\",\"value\":\"$.msg\",\"description\":\"\"}]}","parseTopicanswer":"{\"method\":\"js\",\"url\":\"internal JavaScript\",\"detach\":false,\"body\":\"var host = getcontext(\\\"@@host\\\");\\nvar courseid = getcontext(\\\"courseid\\\");\\nvar urlRegex = /(https?:\\\\/\\\\/[^\\\\s]+)/g;\\nvar sections = getcontext(\\\"sectionsJson\\\");\\nvar resobj = JSON.parse(sections);\\nfor (const key in resobj.db) {\\n if (key !== null && key !== \\\"\\\") {\\n\\t const searchPattern = /^\\\\s*\\\\d*\\\\.\\\\s*/; \\n  \\t const empty = \\\"\\\";\\n    const newkey = key.replace(searchPattern, empty);\\n    const matchedResult = answer.match(newkey);\\n\\n     if (matchedResult) {\\n          var replacement = '[' + newkey + ']('+host+'/course/view.php?id='+courseid+'#section-' + resobj.db[key].section + ')';\\n  return replacement;\\n}  }  }\\nreturn \\\"none\\\";\\n\",\"request\":{\"params\":[{\"key\":\"answer\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"\",\"description\":\"\"}]}","setdefaultGPT":"{\"method\":\"get\",\"url\":\"http://gptqna/setdefault\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"topic\",\"value\":\"CA 3\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"msg\",\"value\":\"$.msg\",\"description\":\"\"}]}","similarGPT":"{\"method\":\"get\",\"url\":\"http://gptqna/similar\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"q\",\"value\":\"jautājums\",\"description\":\"\",\"locked\":false},{\"key\":\"topic\",\"value\":\"CA MD\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"context\",\"value\":\"$.context\",\"description\":\"\"},{\"key\":\"scores\",\"value\":\"$.scores\",\"description\":\"\"},{\"key\":\"topic\",\"value\":\"$.topic\",\"description\":\"\"},{\"key\":\"res\",\"value\":\"$\",\"description\":\"\"}]}","command:getcoursesections":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:getcoursesections\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"$\",\"description\":\"\"}]}","command:getcoursesections:JS:getSectionId":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var sections = getcontext(sections);\\nvar resobj = JSON.parse(sections);\\nsectionid = \\\"\\\"; \\nfor (const key in resobj) {\\n  if (resobj[key].name ==   name){\\n  \\tsectionid = \\\"#section-\\\" + resobj[key].section;\\n  }\\n }\\nreturn sectionid;\",\"request\":{\"params\":[{\"key\":\"sections\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"name\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"sectionid\",\"value\":\"\",\"description\":\"\"}]}","command:getcoursesections:JS:array":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var sections = getcontext(sections);\\nvar resobj = JSON.parse(sections);\\nvar section_array = []; \\nfor (const key in resobj) {\\n if(resobj[key].name && resobj[key].name != null && resobj[key].name.length >0){\\n  section_array.push(resobj[key].name); \\n }\\n }\\n\\nreturn section_array;\",\"request\":{\"params\":[{\"key\":\"sections\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"section_array\",\"value\":\"\",\"description\":\"\"}]}","getTime":"{\"method\":\"get\",\"url\":\"https://timeapi.io/api/Time/current/zone?timeZone=Europe/Riga\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"hour\",\"value\":\"$.hour\",\"description\":\"\"},{\"key\":\"date\",\"value\":\"$.date\",\"description\":\"\"}]}","_html_text_replace":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var htmlText=getcontext(context);\\nif (htmlText && htmlText != \\\"\\\" && htmlText.indexOf(\\\"error:\\\") != 0) {\\n   const plainText = htmlText.replace(/<[^>]+>/g, ''); // Remove HTML tags\\n//  setcontext(\\\"htmltext\\\", plainText);\\n  return plainText;\\n    }\",\"request\":{\"params\":[{\"key\":\"context\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"res\",\"value\":\"\",\"description\":\"\"}]}","command:getquizzesstats:JS:getquizstatus":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\n\\nif (quizzes.toLowerCase().indexOf(\\\"error\\\") !== -1){\\nreturn \\\"Nevarēju izgūt informāciju. Lūdzu, atveriet čata logu pa jaunam un mēģiniet vēlreiz\\\";\\n}\\n\\nvar host = getcontext(\\\"@@host\\\"); \\nvar courseid = getcontext(\\\"courseid\\\");\\nvar resobj = JSON.parse(quizzes);\\nvar result = \\\"\\\";\\nfor (const key in resobj) {\\n\\n    var quiz = resobj[key];\\n\\n  \\tresult += \\\"[\\\" + quiz.section_name+\\\"](\\\" + host + \\\"/course/view.php?id=\\\" + courseid + \\\"#section-\\\" + quiz.section_id + \\\") | [\\\" + quiz.name+\\\"](\\\" + host + \\\"/mod/quiz/view.php?id=\\\"+ quiz.coursemodule+\\\") \\\\n\\\\n\\\"  ;\\n \\t\\n  \\tresult += \\\"\\\\n\\\\n**Atvērts**: \\\" + quiz.t_timeopen;\\n\\tresult += \\\"\\\\n\\\\n**Tiek slēgts**: \\\" + quiz.t_timeclose;\\n    result += \\\"\\\\n\\\\n**Pabeigts**: \\\" + quiz.maxtimefinish;\\n    result += \\\"\\\\n\\\\**Vērtējums**: \\\" + quiz.finalgrade + \\\" no \\\" + Math.round(quiz.grade) ;\\n    result += \\\"\\\\n\\\\n***\\\\n\\\";\\n\\n }\\n\\nreturn result;\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"\",\"description\":\"\"}]}","chatGPT":"{\"method\":\"get\",\"url\":\"http://gptqna/chat\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"q\",\"value\":\"jautājums\",\"description\":\"\",\"locked\":false},{\"key\":\"prompt\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"session_id\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true},{\"key\":\"topic\",\"value\":\"camd\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"answer\",\"value\":\"$\",\"description\":\"\"},{\"key\":\"topic\",\"value\":\"$.topic\",\"description\":\"\"},{\"key\":\"history\",\"value\":\"$.history\",\"description\":\"\"}]}","command_JS_quizes_getattempts":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\nvar resobj = JSON.parse(quizzes);\\nvar result = \\\"Testu atļautās kārtošanas reizes: \\\\n\\\\n\\\";\\n result += \\\"|    Nosaukums      |   Reizes   |\\\\n\\\"; \\n result += \\\"| ----------------------  |  ---------------------- |\\\\n\\\";\\n\\n  \\nfor (const key in resobj) {\\n  result += \\\"|    \\\" + resobj[key].name + \\\"    |    \\\"   + resobj[key].attempts +  \\\"    |\\\\n\\\";\\n  /* result += \\\"*Nosaukums:* \\\" + resobj[key].name + \\\" -> *kārtošanas reizes:* \\\" + resobj[key].attempts + \\\"  \\\\n\\\\n\\\";  */\\n }\\nreturn result;\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"\",\"description\":\"\"}]}","command:getquizzesstats:JS:getquiz":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\nvar host = getcontext(\\\"@@host\\\"); \\nvar courseid = getcontext(\\\"courseid\\\");\\nvar resobj = JSON.parse(quizzes);\\nvar result = \\\"\\\";\\nfor (const key in resobj) {\\n  if(resobj[key].id == id){\\n    var quiz = resobj[key];\\n    setcontext(\\\"instance-id\\\",  quiz.coursemodule);\\n    setcontext(\\\"end-date\\\", quiz.t_timeclose);\\n    setcontext(\\\"student-ids\\\", quiz.failuserids.join(\\\",,\\\") );\\n  \\tresult += \\\"✍️ [\\\" + quiz.section_name+\\\"](\\\" + host + \\\"/course/view.php?id=\\\" + courseid + \\\"#section-\\\" + quiz.section_id + \\\") | [\\\" + quiz.name+\\\"](\\\" + host + \\\"/mod/quiz/view.php?id=\\\"+ quiz.coursemodule+\\\") \\\\n\\\\n\\\"  ;\\n  result += \\\"Tests jāpabeidz līdz \\\" +quiz.t_timeclose + \\\" \\\\n\\\\n\\\" ;\\n result += \\\"***  \\\\n\\\\n\\\";\\n result += \\\"**Testu nokārtojuši:** \\\"+  quiz.passCount + \\\" \\\\n\\\\n\\\" ;\\n result += \\\"***     \\\\n\\\\n\\\" ;\\n result += \\\"**Parādnieku skaits:** \\\"+  quiz.failCount + \\\" \\\\n\\\\n\\\" ;\\n result += \\\"***    \\\\n\\\\n\\\" ;\\n result += \\\"[Rezultātu pārskats](\\\" + host + \\\"/mod/quiz/report.php?id=\\\"+ quiz.coursemodule+\\\"&mode=overview) \\\\n\\\\n\\\" ;\\n    \\n    \\n  };    \\n }\\n\\nreturn result;\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"id\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"\",\"description\":\"\"}]}","command:settimeclose":"{\"method\":\"get\",\"url\":\"#@@host#/blocks/tildeva/chat_ajax.php\",\"detach\":false,\"body\":\"\",\"request\":{\"params\":[{\"key\":\"action\",\"value\":\"msg\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_msg\",\"value\":\"command:settimeclose|55|2023-07-24 10:10:04|2024-07-24 10:10:04\",\"description\":\"\",\"locked\":false},{\"key\":\"chat_usid\",\"value\":\"#userid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_couid\",\"value\":\"#courseid\",\"description\":\"\",\"locked\":true},{\"key\":\"chat_convid\",\"value\":\"#@@conversationid\",\"description\":\"\",\"locked\":true}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"$\",\"description\":\"\"},{\"key\":\"name\",\"value\":\"$.quiz.name\",\"description\":\"\"},{\"key\":\"timeclose\",\"value\":\"$.quiz.timeclose\",\"description\":\"\"}]}","command:feedback":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var conversationid = getcontext(\\\"@@conversationid\\\");\\nvar host = getcontext(\\\"@@host\\\");\\nvar userid = getcontext(\\\"userid\\\");\\nvar courseid = getcontext(\\\"courseid\\\");\\n\\n\\n\\nvar url = host+\\\"/blocks/tildeva/chat_ajax.php?action='msg'&chat_msg=command:feedback|\\\"+title+\\\"|\\\"+msg+\\\"&chat_usid=\\\"+userid+\\\"&chat_convid=\\\"+conversationid+\\\"&chat_couid=\\\" + courseid;\\n\\nvar resp = httpget(url);\\n if (resp && resp != \\\"\\\" && resp.indexOf(\\\"error:\\\") != 0) {    \\n  \\n    setcontext(\\\"apistatuss\\\", 200);\\n }\\n  else\\n  {\\n    setcontext(\\\"apistatuss\\\", 500);\\n  }\\n\\nreturn resp;\\n\",\"request\":{\"params\":[{\"key\":\"title\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"msg\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"resp\",\"value\":\"\",\"description\":\"\"}]}","parseanswer":"{\"method\":\"js\",\"url\":\"internal JavaScript\",\"detach\":false,\"body\":\"var host = getcontext(\\\"@@host\\\");\\nvar courseid = getcontext(\\\"courseid\\\");\\nvar failed  = getcontext(failed);\\nvar answer = getcontext(answer);\\nvar incorrectansw = getcontext(incorrect);\\n\\nif ((answer.toLowerCase().indexOf(\\\"sorry\\\") !== -1)||(answer.toLowerCase().indexOf(\\\"atvaino\\\") !== -1)||(answer.toLowerCase().indexOf(\\\"diemžēl\\\") !== -1)){\\n  setcontext(\\\"noanswer\\\", \\\"true\\\");\\n\\treturn failed;\\n};\\n\\nif (answer.toLowerCase().indexOf(\\\"error\\\") !== -1){\\n  setcontext(\\\"noanswer\\\", \\\"true\\\");\\n\\treturn incorrectansw;\\n};\\n\\nvar urlRegex = /(https?:\\\\/\\\\/[^\\\\s]+)/g;\\n  // Replace URLs with Markdown links\\n  var answer = answer.replace(urlRegex, function(url) {\\n    return '[' + url + '](' + url + ')';\\n  });\\n\\nvar sections = getcontext(\\\"sectionsJson\\\");\\n if (sections !== null && sections !== \\\"\\\" && sections.length>5) {\\n   setcontext(\\\"xx\\\", sections);\\n    var resobj = JSON.parse(sections);\\n    for (const key in resobj.db) {\\n         if (key !== null && key !== \\\"\\\") {\\n            const searchPattern = /^\\\\s*\\\\d*\\\\.\\\\s*/; \\n            const empty = \\\"\\\";\\n            const newkey = key.replace(searchPattern, empty);\\n            var replacement = '[' + newkey + ']('+host+'/course/view.php?id='+courseid+'#section-' + resobj.db[key].section + ')'; \\n            answer = answer.replace(newkey, replacement);\\n            }  \\n    }\\n}\\nreturn answer;\",\"request\":{\"params\":[{\"key\":\"answer\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"failed\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"incorrect\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"}]}","command:getquizzesstats:JS:getstudentquiz":"{\"method\":\"js\",\"url\":\"\",\"detach\":false,\"body\":\"var quizzes = getcontext(quizzes);\\nvar host = getcontext(\\\"@@host\\\"); \\nvar courseid = getcontext(\\\"courseid\\\");\\nvar resobj = JSON.parse(quizzes);\\nvar result = \\\"\\\";\\nfor (const key in resobj) {\\n  if(resobj[key].id == id){\\n    var quiz = resobj[key];\\n    setcontext(\\\"instance-id\\\",  quiz.coursemodule);\\n    setcontext(\\\"end-date\\\", quiz.t_timeclose);\\n  \\tresult += \\\"✍️ [\\\" + quiz.section_name+\\\"](\\\" + host + \\\"/course/view.php?id=\\\" + courseid + \\\"#section-\\\" + quiz.section_id + \\\") | [\\\" + quiz.name+\\\"](\\\" + host + \\\"/mod/quiz/view.php?id=\\\"+ quiz.coursemodule+\\\") \\\\n\\\\n\\\"  ;\\n  result += \\\"Tests jāpabeidz līdz \\\" +quiz.t_timeclose + \\\" \\\\n\\\\n\\\" ;\\n     result += \\\"Jūsu gala vērtējums šajā testā ir: \\\" +quiz.finalgrade + \\\" no \\\" + Math.round(quiz.grade)+\\\" \\\\n\\\\n\\\" ;\\n result += \\\"***    \\\\n\\\\n\\\" ;\\nif (quiz.finalgrade>=7){\\n result += \\\"NOKĀRTOTS  \\\\n\\\\n\\\" ;\\n}\\n else{\\n    result += \\\"`NAV NOKĀRTOTS`  \\\\n\\\\n\\\" ;\\n }\\n  };    \\n }\\nreturn result;\",\"request\":{\"params\":[{\"key\":\"quizzes\",\"value\":\"\",\"description\":\"\",\"locked\":false},{\"key\":\"id\",\"value\":\"\",\"description\":\"\",\"locked\":false}],\"authorization\":[\"\"],\"headers\":[],\"formData\":[]},\"responseType\":\"json\",\"response\":[{\"key\":\"status\",\"value\":\"StatusCode\",\"description\":\"status code\"},{\"key\":\"result\",\"value\":\"\",\"description\":\"\"}]}"}